# Balance Proxy - Consistent Hashing Example
# This configuration demonstrates consistent hashing for session persistence

# Proxy mode
mode: tcp

# Listen address
listen: ":8080"

# Backend servers
backends:
  - name: backend-1
    address: "localhost:9001"
    weight: 1
    max_connections: 1000

  - name: backend-2
    address: "localhost:9002"
    weight: 1
    max_connections: 1000

  - name: backend-3
    address: "localhost:9003"
    weight: 1
    max_connections: 1000

# Load balancer configuration
load_balancer:
  # Use "consistent-hash" for basic consistent hashing
  # Use "bounded-consistent-hash" for consistent hashing with load bounds
  algorithm: consistent-hash

  # Hash key determines what to hash for consistent routing
  # Options: "source-ip" (default)
  hash_key: source-ip

# Timeout configuration
timeouts:
  connect: 5s
  read: 30s
  write: 30s
  idle: 60s

# Metrics configuration
metrics:
  enabled: true
  listen: ":9090"
  path: /metrics
